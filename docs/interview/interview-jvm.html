<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-interview/interview-jvm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">JVM 篇 | 与你同行-黑铁教程</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://yntx-it.github.io/yntx-black-iron-tutorial-fronted/docs/interview/interview-jvm"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JVM 篇 | 与你同行-黑铁教程"><meta data-rh="true" name="description" content="1.JVM 内存结构"><meta data-rh="true" property="og:description" content="1.JVM 内存结构"><link data-rh="true" rel="icon" href="/yntx-black-iron-tutorial-fronted/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://yntx-it.github.io/yntx-black-iron-tutorial-fronted/docs/interview/interview-jvm"><link data-rh="true" rel="alternate" href="https://yntx-it.github.io/yntx-black-iron-tutorial-fronted/docs/interview/interview-jvm" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://yntx-it.github.io/yntx-black-iron-tutorial-fronted/docs/interview/interview-jvm" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/yntx-black-iron-tutorial-fronted/blog/rss.xml" title="与你同行-黑铁教程 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/yntx-black-iron-tutorial-fronted/blog/atom.xml" title="与你同行-黑铁教程 Atom Feed"><link rel="stylesheet" href="/yntx-black-iron-tutorial-fronted/assets/css/styles.39c269dc.css">
<link rel="preload" href="/yntx-black-iron-tutorial-fronted/assets/js/runtime~main.713cf9ba.js" as="script">
<link rel="preload" href="/yntx-black-iron-tutorial-fronted/assets/js/main.6be573e1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/yntx-black-iron-tutorial-fronted/"><div class="navbar__logo"><img src="/yntx-black-iron-tutorial-fronted/img/logo.svg" alt="黑铁教程 Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/yntx-black-iron-tutorial-fronted/img/logo.svg" alt="黑铁教程 Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">与你同行-黑铁教程</b></a><a class="navbar__item navbar__link" href="/yntx-black-iron-tutorial-fronted/docs/java">Java教程</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/yntx-black-iron-tutorial-fronted/docs/interview">面试宝典</a><a class="navbar__item navbar__link" href="/yntx-black-iron-tutorial-fronted/blog">博客</a><a href="https://github.com/yntx-it" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/yntx-black-iron-tutorial-fronted/docs/interview">常见面试题</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-algorithm">算法篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-design">设计模式篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-base">基础篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-collection">集合篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-concurrency">并发篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-jvm">JVM 篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-microservice">微服务篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-mysql">MySQL 篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-redis">Redis 篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-mq">MQ 篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-spring">Spring 篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-mybatis">MyBatis 的原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-other">补充篇</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/yntx-black-iron-tutorial-fronted/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/yntx-black-iron-tutorial-fronted/docs/interview"><span itemprop="name">常见面试题</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JVM 篇</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>JVM 篇</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1jvm-内存结构">1.JVM 内存结构<a class="hash-link" href="#1jvm-内存结构" title="标题的直接链接">​</a></h2><p>记住这个图</p><p><img loading="lazy" alt="image-20220401144305110" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401144305110-b11da2dbe76c8cb1eef35162c5d5c6c4.png" width="960" height="391" class="img_ev3q"></p><p><strong>运行时数据区</strong>：方法区、堆、虚拟机栈、本地方法栈、程序计数器。</p><blockquote><p><strong>方法区</strong>：类的元数据、即时编译器的代码缓存。</p></blockquote><blockquote><p><strong>堆</strong>：用来存放对象实例。JDK7 把字符串常量池、静态变量放到了堆中。</p></blockquote><blockquote><p><strong>虚拟机栈</strong>：每个方法执行时都会创建一个栈帧，存放局部变量表、操作数栈、动态连接、方法出口等信息。</p></blockquote><blockquote><p><strong>本地方法栈</strong>：和虚拟机栈类似，主要是 Native 方法存储相关信息。Oracle 的 Hotspot 虚拟机是合二为一的。</p></blockquote><blockquote><p><strong>程序计数器</strong>：用来记录当前线程下一条 JVM 字节码指令的执行地址。如果是本地方法计数器为空。</p></blockquote><ul><li>堆和方法区是<strong>线程共享</strong>的。</li><li>虚拟机栈、本地方法栈、程序计数器是<strong>线程私有</strong>的。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="内存溢出的区域">内存溢出的区域<a class="hash-link" href="#内存溢出的区域" title="标题的直接链接">​</a></h3><p><strong>程序计数器</strong>不会内存溢出。</p><p><strong>OutOfMemoryError</strong>：</p><ul><li>堆内存耗尽：对象越来越多，一直使用不能回收。</li><li>方法区内存耗尽：加载的类越来越多，动态生成大量类。</li><li>虚拟机栈耗尽：每个线程最多占用 1M 内存，线程个数越来越多，又不销毁。</li></ul><p><strong>StackOverflowError</strong>：</p><ul><li>JVM 虚拟机栈：==方法递归==调用没有正确结束，反序列化 JSON 时==循环引用==。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oom-内存溢出问题">OOM 内存溢出问题<a class="hash-link" href="#oom-内存溢出问题" title="标题的直接链接">​</a></h2><p>说出几种典型的内存溢出情况</p><ul><li>==堆内存==：线程池使用无界阻塞队列 LinkedBlockingQueue，任务堆满了，堆内存溢出。</li><li>==堆内存==：查询数据量太大。</li><li>==虚拟机栈==：线程池使用 newCachedThreadPool，线程创建数量大，超过了虚拟机允许最大栈内存。</li><li>==方法区==：反射动态生成类。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="方法区永久代元空间之间的关系">方法区、永久代、元空间之间的关系<a class="hash-link" href="#方法区永久代元空间之间的关系" title="标题的直接链接">​</a></h3><ul><li>方法区：JVM 规范定义的一块内存区域，用来存储类元数据、方法字节码、即时编译器需要的信息。</li><li>永久代：1.8 <strong>前</strong> Hotspot 虚拟机对 JVM 规范的实现</li><li>元空间：1.8 <strong>后</strong> Hotspot 虚拟机对 JVM 规范的实现，使用<strong>本地内存</strong>作为这些信息的存储空间。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见的-jvm-内存参数">常见的 JVM 内存参数<a class="hash-link" href="#常见的-jvm-内存参数" title="标题的直接链接">​</a></h2><p>-Xms：最小堆内存</p><p>-Xmx：最大堆内存</p><p><strong>建议设置成大小相等，不需要保留内存来动态扩大和缩小，这样性能好。</strong></p><p>-XX:NewSize 与 -XX:NewSize 设置新生代的最小值和最大值，建议不要设置，JVM 自己控制。</p><p>-Xmn：设置新生代大小，相当于同时设置了-XX:NewSize 与 -XX:NewSize，并且取值相等。</p><p>-XX:SurvivorRatio：幸存区比例</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="垃圾回收算法">垃圾回收算法<a class="hash-link" href="#垃圾回收算法" title="标题的直接链接">​</a></h2><p>三种算法：<strong>标记清除</strong>、<strong>标记整理</strong>、<strong>标记复制</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-标记清除法">1. 标记清除法<a class="hash-link" href="#1-标记清除法" title="标题的直接链接">​</a></h3><p>过程：</p><ol><li><p>找到 GC Root 对象（GC Root 对象：一定不会被回收的对象，<strong>局部变量</strong>和<strong>静态变量</strong>引用的对象）</p></li><li><p>标记阶段：沿着 GC Root 对象的引用链找，直接或间接引用到的对象加上标记</p></li><li><p>清除阶段：直接释放未加标记对象占用的内存</p></li></ol><p>优点：速度较快</p><p>缺点：会产内存碎片，造成空间不连续</p><p>要点：</p><ul><li>标记速度和存活对象成线性关系</li><li>清除速度和对象大小成线性关系</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-标记整理法">2. 标记整理法<a class="hash-link" href="#2-标记整理法" title="标题的直接链接">​</a></h3><p>过程：</p><ol><li><p>标记阶段、清除阶段和标记清除法类似</p></li><li><p>整理阶段：将存活对象朝着一段移动，避免内存碎片产生</p></li></ol><p>优点：没有内存碎片</p><p>缺点：速度比标记清除慢</p><p>要点：</p><ul><li>标记速度和存活对象成线性关系</li><li>清除与整理速度和对象大小成线性关系</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-标记复制法">3. 标记复制法<a class="hash-link" href="#3-标记复制法" title="标题的直接链接">​</a></h3><p>过程：</p><ol><li>将整个内存分为两块大小相等的区域，from 和 to，其中 to 总是处于空闲，from 存储新创建的对象</li><li>标记阶段和前面算法类型</li><li>找出存活对象后，会把他们从 from 复制到 to 区域，复制过程中自然完成了碎片整理</li><li>复制完成后，交换 from 和 to 的位置</li></ol><p>特点：</p><ul><li>标记与复制速度与存活对象成线性关系</li></ul><p>优点：没有内存碎片，比标记整理速度快</p><p>缺点：占用双倍内存空间</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3gc-和分代回收算法">3.GC 和分代回收算法<a class="hash-link" href="#3gc-和分代回收算法" title="标题的直接链接">​</a></h2><p>GC：就是垃圾回收，实现对无用对象内存自动释放，减少内存碎片、加快分配速度。</p><p>回收区域：堆内存，不用回收虚拟机栈，虚拟机栈内存随着线程的销毁而释放</p><p>可以作为 GC Roots 的对象：</p><ol><li>虚拟机栈栈帧的本地变量表引用的对象</li><li>方法区静态变量引用的对象</li><li>方法区常量引用的对象</li><li>本地方法栈中 JNI（Native 方法）引用的对象</li><li>虚拟机内部的引用，Class 类、异常类、类加载器</li><li>synchronized 关键字修饰的对象</li></ol><p>判断无用对象：可达性分析算法、三色标记法，标记存活对象，回收未标记对象</p><ul><li>三色标记：黑色已标记，灰色标记中，白色还未标记</li></ul><p>分代回收思想：</p><ul><li><p>大部分对象都是朝生夕灭的，用完立刻就可以回收。熬过越多次垃圾回收的对象就越难以消亡。</p></li><li><p>根据这个特性，将回收区域分为老年代和新生代，新生代一般采用标记复制算法，老年代一般采用标记整理算法。</p></li><li><p>新生代：伊甸园 eden、幸存区 survivor（分为 from 和 to）</p><p>老年代：幸存区对象熬过最多 15 次垃圾回收，晋升到老年代。（幸存区内存不足或者大对象会导致提前晋升）</p></li></ul><p>GC 规模：Minor GC，Mixed GC，Full GC</p><ul><li>Minor GC：发生在新生代，暂停时间短</li><li>Mixed GC：发生在新生代和老年代，G1 收集器特有的</li><li>Full GC：发生在新生代和老年代完整垃圾回收，暂停时间长，尽力避免</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-垃圾回收器">4. 垃圾回收器<a class="hash-link" href="#4-垃圾回收器" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-serial-串行">1. Serial 串行<a class="hash-link" href="#1-serial-串行" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20220401155958302" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401155958302-c338d86b03ed9d69b84f7cacb4e4c46f.png" width="788" height="244" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-parallel-吞吐量优先">2. Parallel 吞吐量优先<a class="hash-link" href="#2-parallel-吞吐量优先" title="标题的直接链接">​</a></h3><p>Serial 收集器的多线程版本</p><p><img loading="lazy" alt="image-20220401160015687" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401160015687-b00f76419d930a50163e3db17f8b5776.png" width="800" height="253" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-cms-响应时间优先">3. CMS 响应时间优先<a class="hash-link" href="#3-cms-响应时间优先" title="标题的直接链接">​</a></h3><p>初始标记、并发标记、重新标记、并发清理</p><p><img loading="lazy" alt="image-20220401160259915" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401160259915-325fc7e0756a7310de849b7a00a06d8e.png" width="936" height="258" class="img_ev3q"></p><p>重新标记会根据卡表再次遍历</p><p>并发清理可能产生浮动垃圾，可能导致并发失败，采用 Serial Old 收集器</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-g1-吞吐量--低延迟-jdk-9-默认">4. G1 吞吐量 + 低延迟 JDK 9 默认<a class="hash-link" href="#4-g1-吞吐量--低延迟-jdk-9-默认" title="标题的直接链接">​</a></h3><p>G1 垃圾回收器：注重吞吐量和低延时（默认 200ms），会把堆划分成多个大小相等的 Region，2048 左右个，每个在 1~32MB 之间。</p><p>分代：每个 Region 代表一个类型，young、old。</p><ul><li>young：eden、survivor</li><li>old：old、Humongous（超过 region 的一半时）</li></ul><p>整体上是<strong>标记整理</strong>算法，两个区域之间是<strong>复制算法</strong></p><p>回收阶段：</p><ol><li>Young Collection：会 STW，初始标记。</li><li>Young Collection + Concurrent Mrak ：老年代堆空间比例达到阈值时，并发标记，不会 STW</li><li>Mixed Collection：会对 Eden、Survivor、Old 进行全面的垃圾回收<ul><li>最终标记 会 STW</li><li>拷贝存活 会 STW</li></ul></li></ol><p><img loading="lazy" alt="image-20220401160256332" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401160256332-0264cac71b66d83b1503492a8879ef6e.png" width="586" height="487" class="img_ev3q"></p><p>多标问题：产生浮动垃圾。</p><p><code>并发标记时漏标</code>问题：</p><ol><li><p>==增量更新法（Incremental Update）==，CMS 垃圾回收器采用，写屏障 + 增量更新</p><ul><li>每次拦截赋值动作，只要赋值发生，被赋值的对象就会被记录下来，在重新标记阶段再确认一遍。</li></ul></li><li><p>==原始快照法（SATB，Snapshot At The Beginning）==，G1 垃圾回收器采用，写屏障 + 原始快照</p><ul><li>每次拦截赋值动作，不过记录的对象不同，也需要在重新标记阶段对这些对象二次处理</li><li>新加对象会被记录</li><li>被删除的引用关系的对象也被记录</li></ul></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="跨代引用问题">跨代引用问题<a class="hash-link" href="#跨代引用问题" title="标题的直接链接">​</a></h4><p>老年代引用新生代，新生代回收时遍历的问题</p><p>方法：每个 Region 都维护了一个记忆集卡表，一旦一个老年代对象引用了新生代对象时，都标记为脏 card。</p><p>每次对象引用变更时通过一个写后屏障来维护。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="类加载过程">类加载过程<a class="hash-link" href="#类加载过程" title="标题的直接链接">​</a></h2><ol><li><p><code>加载</code></p><ol><li><p>将类的字节码载入方法区，并创建类的 class 对象</p></li><li><p>如果这个类的父类没有加载，先加载父类</p></li><li><p>加载是懒惰执行的，用到了才加载</p></li></ol></li><li><p><code>链接</code></p><ol><li>==验证==：验证是否符合 Class 规范，合法性、安全性检查</li><li>==准备==：为 static 变量分配空间，设置默认值，static final 修饰的基本类型变量赋值</li><li>==解析==：将常量池的符号引用解析为直接引用，这一步可以和初始化互换顺序</li></ol></li><li><p><code>初始化</code></p><ol><li>静态代码块、static 修饰的变量赋值、static final 修饰的引用类型变量赋值，会被合并成一个 cinit 方法，在初始化时被调用</li><li>static final 修饰的基本类型变量赋值，在链接阶段就完成</li><li>初始化也是懒惰执行</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="类加载器">类加载器<a class="hash-link" href="#类加载器" title="标题的直接链接">​</a></h2><p>JDK 8 的类加载器</p><table><thead><tr><th>名称</th><th>加载哪的类</th><th>说明</th></tr></thead><tbody><tr><td>Bootstrap ClassLoader 启动类加载器</td><td>JAVA_HOME/jre/lib</td><td>无法直接访问</td></tr><tr><td>Extension ClassLoader 扩展类加载器</td><td>JAVA_HOME/jre/lib/ext</td><td>上级为 Bootstrap，显示为 null</td></tr><tr><td>Application ClassLoader 应用类加载器</td><td>classpath</td><td>上级为 Extension</td></tr><tr><td>自定义类加载器</td><td>自定义</td><td>上级为 Application</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="双亲委派模型">双亲委派模型<a class="hash-link" href="#双亲委派模型" title="标题的直接链接">​</a></h2><p>含义：优先委派上级类加载器进行加载，如果上级类加载器</p><ul><li>能找到这个类，由上级加载，加载后该类对下级类加载器可见</li><li>找不到这个类，则下级类加载器才有资格加载</li></ul><p>目的：</p><ol><li>让上级类加载器的类对下级共享，即能让你的类依赖到 JDK 的核心类</li><li>让类的加载有优先次序，保证核心类优先加载</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四种引用类型">四种引用类型<a class="hash-link" href="#四种引用类型" title="标题的直接链接">​</a></h2><p>分别是：强引用、软引用、弱引用、虚引用</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="强引用">强引用<a class="hash-link" href="#强引用" title="标题的直接链接">​</a></h3><ol><li>普通变量赋值就是强引用，如 ==A a = new A();==</li><li>通过 GC Root 的引用链，如果强引用找不到该对象，该对象才能被回收。</li></ol><p><img loading="lazy" alt="image-20220401172006437" src="data:image/png;base64,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" width="383" height="90" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="软引用-softreference">软引用 SoftReference<a class="hash-link" href="#软引用-softreference" title="标题的直接链接">​</a></h3><ol><li>例如：==SoftReference a = new SoftReference(new A());==</li><li>如果仅有软引用引用该对象时，首次垃圾回收不会回收该对象，如果内存仍然不足，再次垃圾回收才会回收</li><li>软引用的自身需要配合引用队列来释放</li><li>典型例子是反射数据</li></ol><p><img loading="lazy" alt="image-20220401172149829" src="/yntx-black-iron-tutorial-fronted/assets/images/image-20220401172149829-88479e5293f6c7c19ded55e1cfd52edb.png" width="618" height="88" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="弱引用-weakreference">弱引用 WeakReference<a class="hash-link" href="#弱引用-weakreference" title="标题的直接链接">​</a></h3><ol><li>例如：==WeakReference a = new WeakReference(new A());==</li><li>如果仅有弱引用引用该对象时，发生垃圾回收就会释放对象</li><li>弱引用自身需要配合引用队列来释放</li><li>典型例子是 ThreadLocalMap 中的 Entry 对象</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="虚引用-phantomreference">虚引用 PhantomReference<a class="hash-link" href="#虚引用-phantomreference" title="标题的直接链接">​</a></h3><ol><li>例如：==PhantomReference a = new PhantomReference(new A(), referenceQueue);==</li><li>必须配合引用队列一起使用，当虚引用所引用的对象被回收时，由 Reference Handler 线程将虚引用对象入队，这样就可以知道哪些对象来回收，从而对他们关联的资源做进一步处理</li><li>典型例子就是 Cleaner 释放 DirectByteBuffer 关联的直接内存</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="finalize-关键字的理解">finalize 关键字的理解<a class="hash-link" href="#finalize-关键字的理解" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finalize">finalize<a class="hash-link" href="#finalize" title="标题的直接链接">​</a></h3><p>它是 Object 中的一个方法，如果子类重写它，垃圾回收时此方法会被调用，可以在其中进行资源
释放和清理工作。
但是，将资源释放和清理放在 finalize 方法中非常不好，<strong>非常影响性能</strong>，严重时甚至会引起 <strong>OOM</strong>，从
Java9 开始就被标注为 ==@Deprecated==，不建议被使用了</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finalize-原理">finalize 原理<a class="hash-link" href="#finalize-原理" title="标题的直接链接">​</a></h3><ol><li><p>对 finalize 方法进行处理的核心逻辑位于 ==java.lang.ref.Finalizer== 类中，它包含了名为 ==unfinalized==
的静态变量（双向链表结构），Finalizer 也可被视为另一种引用对象（地位与软、弱、虚相当，只
是不对外，无法直接使用）</p></li><li><p>当重写了 finalize 方法的对象，在构造方法调用之时，JVM 都会将其包装成一个 ==Finalizer== 对象，并
加入 ==unfinalized 链表==中</p></li><li><p>Finalizer 类中还有另一个重要的静态变量，即 ==ReferenceQueue== 引用队列，刚开始它是空的。当
狗对象可以被当作垃圾回收时，就会把这些狗对象对应的 Finalizer 对象加入此引用队列</p></li><li><p>但此时 Dog 对象还没法被立刻回收，因为 unfinalized -&gt; Finalizer 这一引用链还在引用它嘛，为
的是【先别着急回收啊，等我调完 finalize 方法，再回收】</p></li><li><p>==FinalizerThread== 线程会从 ReferenceQueue 中逐一取出每个 Finalizer 对象，把它们从链表断开并
真正调用 finallize 方法</p></li><li><p>由于整个 Finalizer 对象已经从 unfinalized 链表中断开，这样没谁能引用到它和狗对象，所以下次
gc 时就被回收了</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finalize-缺点">finalize 缺点<a class="hash-link" href="#finalize-缺点" title="标题的直接链接">​</a></h3><ul><li>无法保证资源释放：FinalizerThread 是守护线程，代码很有可能没来得及执行完，线程就结束了</li><li>无法判断是否发生错误：执行 finalize 方法时，会吞掉任意异常（Throwable）</li><li>内存释放不及时：重写了 finalize 方法的对象在第一次被 gc 时，并不能及时释放它占用的内存，</li><li>因为要等着 FinalizerThread 调用完 finalize，把它从 unfinalized 队列移除后，第二次 gc 时才能真正释放内存</li><li>有的文章提到【Finalizer 线程会和我们的主线程进行竞争，不过由于它的优先级较低，获取到的
CPU 时间较少，因此它永远也赶不上主线程的步伐】这个显然是错误的，FinalizerThread 的优先
级较普通线程更高，原因应该是 finalize 串行执行慢等原因综合导致</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何排查频繁-full-gc">如何排查频繁 Full GC？<a class="hash-link" href="#如何排查频繁-full-gc" title="标题的直接链接">​</a></h2><ul><li>代码层面：System.gc()调用，一般不会调用</li><li>新生代空间太小，youngGC 频繁，存活对象太多，但是 survivor 放不下，导致对象过早进入老年代</li><li>老年代空间不足，大对象直接进入</li><li>元空间内存不足：大量代理类，类加载器是活的，元空间类的元数据也是活的。</li></ul><ol><li>==top -c==： 找到 cpu 占用很高的进程 ID：==PID==</li><li>jstat -gc pid 查看 GC 情况</li><li>jmap -dump:format=b,file=temp.dump pid dump 文件</li><li>MAT 分析是否有内存泄漏，看是哪个大对象。MAT 查看类的 Histogram 直方图。</li></ol><p>开启 GC log</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+PrintGCDetails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+PrintGCDateStamps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+PrintGCTimeStamps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+PrintTenuringDistribution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Xloggc:/some-path/gc-$(date +%Y%m%d-%H%M%S).log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:+UseGCLogFileRotation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:NumberOfGCLogFiles=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:GCLogFileSize=10M</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何排查-cpu-占用过高的问题">如何排查 CPU 占用过高的问题？<a class="hash-link" href="#如何排查-cpu-占用过高的问题" title="标题的直接链接">​</a></h2><ol><li>==top -c==： 找到 cpu 占用很高的进程 ID：==PID==</li><li>==top -H -p PID==：查看最占用 CPU 的线程 ID</li><li>==printf &quot;0x%x\n&quot; 74318==：得到对应 16 进制线程 ID</li><li>==jstack 进程 ID | grep -A 20 十六进制线程 ID==：打印对应进程的堆栈信息</li><li>找到对应线程的 JAVA 代码行，分析问题</li></ol><p>一般原因可能是死循环，或者频繁 GC</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何排查内存占用很高的问题">如何排查内存占用很高的问题？<a class="hash-link" href="#如何排查内存占用很高的问题" title="标题的直接链接">​</a></h2><ol><li><p>==top -c==：找到 mem 占用很高的进程 ID</p></li><li><p>==top -H -p 111111==：找到占用很高内存的线程</p></li><li><p>如果是线上环境，注意 dump 之前必须先将流量切走，否则大内存 dump 是直接卡死服务。</p><p><code># dump当前快照 jmap -dump:live,format=b,file=dump.hprof &lt;pid&gt;</code></p><p><code># 触发full gc，然后再dump一次 jmap -dump:live,format=b,file=dump_gc.hprof &lt;pid&gt;</code></p><p>dump:live 的作用是会触发 Full GC，然后再 dump 数据，用作 gc 前后的数据做对比。</p></li><li><p>通过 MAT (Memory Analyzer Tools) 分析 dump 文件</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jvm-调优思路">JVM 调优思路<a class="hash-link" href="#jvm-调优思路" title="标题的直接链接">​</a></h2><p>优化指标：<code>吞吐量</code>、<code>停顿时间</code>和<code>垃圾回收频率</code>。</p><p>基于这些我们可能需要调整：</p><ol><li><p>==内存区域大小以及相关策略==：堆内存大小、新生代大小、老年代大小、Survivor 大小、晋升阈值等等</p><ul><li>-Xmx</li><li>-Xms</li><li>-Xmn</li><li>-XX:SurvivorRatio</li></ul><p>按经验来说：IO 密集型的可以稍微把年轻代增大些，内存计算密集型的稍微把老年代增大些。</p></li><li><p>==垃圾回收器==：选择合适的垃圾回收器和垃圾回收期的各种调优参数</p><ul><li>-XX:UseG1GC</li><li>-XX:MaxGCPauseMillis</li><li>-XX:InitialingHeapOccupancyPercent</li></ul></li></ol><blockquote><p>大多数情况下，一般是遇到问题之后才进行调优的。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="jit-即时编译器">JIT 即时编译器<a class="hash-link" href="#jit-即时编译器" title="标题的直接链接">​</a></h2><p>两种技术：<code>方法内联</code>和<code>逃逸分析</code>（==锁消除==、==栈上分配==、==标量替换==）。</p><ul><li><code>方法内联</code>：把目标方法的代码复制到调用的方法中，避免发生真实的方法调用。因为每次方法调用都会生成栈帧，压栈、出栈、记录方法调用位置等等会带来一定的性能损耗，所以方法内联可以提高一定的性能。</li><li><code>逃逸分析</code>：判断一个对象是否被外部方法引用或者外部线程访问的分析技术，如果没有被引用就可以进行优化，例如：<ul><li>==锁消除（同步忽略）==：锁的对象只在方法内被调用，不会被别的地方调用，那么就一定是线程安全的，可以把锁的代码忽略掉。</li><li>==栈上分配==：该对象只会在方法内部被调用，直接把对象分配在栈中而不是堆中，因为堆中对象需要通过垃圾回收器进行回收，需要损耗一定性能</li><li>==标量替换==：当程序执行的时候可以不创建对象，而是直接创建这个对象的成员变量来代替。对象拆分后，可以分配对象的成员变量在栈或寄存器上，原本的对象就不需要分配空间了。</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/yntx-it/yntx-black-iron-tutorial-fronted/tree/master/shared/docs/interview/interview-jvm.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-concurrency"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">并发篇</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/yntx-black-iron-tutorial-fronted/docs/interview/interview-microservice"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">微服务篇</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1jvm-内存结构" class="table-of-contents__link toc-highlight">1.JVM 内存结构</a><ul><li><a href="#内存溢出的区域" class="table-of-contents__link toc-highlight">内存溢出的区域</a></li></ul></li><li><a href="#oom-内存溢出问题" class="table-of-contents__link toc-highlight">OOM 内存溢出问题</a><ul><li><a href="#方法区永久代元空间之间的关系" class="table-of-contents__link toc-highlight">方法区、永久代、元空间之间的关系</a></li></ul></li><li><a href="#常见的-jvm-内存参数" class="table-of-contents__link toc-highlight">常见的 JVM 内存参数</a></li><li><a href="#垃圾回收算法" class="table-of-contents__link toc-highlight">垃圾回收算法</a><ul><li><a href="#1-标记清除法" class="table-of-contents__link toc-highlight">1. 标记清除法</a></li><li><a href="#2-标记整理法" class="table-of-contents__link toc-highlight">2. 标记整理法</a></li><li><a href="#3-标记复制法" class="table-of-contents__link toc-highlight">3. 标记复制法</a></li></ul></li><li><a href="#3gc-和分代回收算法" class="table-of-contents__link toc-highlight">3.GC 和分代回收算法</a></li><li><a href="#4-垃圾回收器" class="table-of-contents__link toc-highlight">4. 垃圾回收器</a><ul><li><a href="#1-serial-串行" class="table-of-contents__link toc-highlight">1. Serial 串行</a></li><li><a href="#2-parallel-吞吐量优先" class="table-of-contents__link toc-highlight">2. Parallel 吞吐量优先</a></li><li><a href="#3-cms-响应时间优先" class="table-of-contents__link toc-highlight">3. CMS 响应时间优先</a></li><li><a href="#4-g1-吞吐量--低延迟-jdk-9-默认" class="table-of-contents__link toc-highlight">4. G1 吞吐量 + 低延迟 JDK 9 默认</a></li></ul></li><li><a href="#类加载过程" class="table-of-contents__link toc-highlight">类加载过程</a></li><li><a href="#类加载器" class="table-of-contents__link toc-highlight">类加载器</a></li><li><a href="#双亲委派模型" class="table-of-contents__link toc-highlight">双亲委派模型</a></li><li><a href="#四种引用类型" class="table-of-contents__link toc-highlight">四种引用类型</a><ul><li><a href="#强引用" class="table-of-contents__link toc-highlight">强引用</a></li><li><a href="#软引用-softreference" class="table-of-contents__link toc-highlight">软引用 SoftReference</a></li><li><a href="#弱引用-weakreference" class="table-of-contents__link toc-highlight">弱引用 WeakReference</a></li><li><a href="#虚引用-phantomreference" class="table-of-contents__link toc-highlight">虚引用 PhantomReference</a></li></ul></li><li><a href="#finalize-关键字的理解" class="table-of-contents__link toc-highlight">finalize 关键字的理解</a><ul><li><a href="#finalize" class="table-of-contents__link toc-highlight">finalize</a></li><li><a href="#finalize-原理" class="table-of-contents__link toc-highlight">finalize 原理</a></li><li><a href="#finalize-缺点" class="table-of-contents__link toc-highlight">finalize 缺点</a></li></ul></li><li><a href="#如何排查频繁-full-gc" class="table-of-contents__link toc-highlight">如何排查频繁 Full GC？</a></li><li><a href="#如何排查-cpu-占用过高的问题" class="table-of-contents__link toc-highlight">如何排查 CPU 占用过高的问题？</a></li><li><a href="#如何排查内存占用很高的问题" class="table-of-contents__link toc-highlight">如何排查内存占用很高的问题？</a></li><li><a href="#jvm-调优思路" class="table-of-contents__link toc-highlight">JVM 调优思路</a></li><li><a href="#jit-即时编译器" class="table-of-contents__link toc-highlight">JIT 即时编译器</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/yntx-black-iron-tutorial-fronted/docs/java">Java教程</a></li><li class="footer__item"><a class="footer__link-item" href="/yntx-black-iron-tutorial-fronted/docs/interview">面试宝典</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/yntx-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/yntx-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/yntx-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/yntx-black-iron-tutorial-fronted/blog">本站博客</a></li><li class="footer__item"><a href="https://github.com/yntx-it" target="_blank" rel="noopener noreferrer" class="footer__link-item">与你同行GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/yntx-org" target="_blank" rel="noopener noreferrer" class="footer__link-item">与你同行Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 与你同行技术, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/yntx-black-iron-tutorial-fronted/assets/js/runtime~main.713cf9ba.js"></script>
<script src="/yntx-black-iron-tutorial-fronted/assets/js/main.6be573e1.js"></script>
</body>
</html>